<!doctype html>
<html lang="en-AU" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-4.3 docs-doc-page docs-doc-id-apis/subsystems/xapi/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">xAPI (Experience API) | Moodle Developer Resources</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://noeldemartin.github.io/moodledevdocs/docs/4.3/apis/subsystems/xapi"><meta data-rh="true" property="og:locale" content="en_AU"><meta data-rh="true" name="docusaurus_locale" content="en-AU"><meta data-rh="true" name="docsearch:language" content="en-AU"><meta data-rh="true" name="docusaurus_version" content="4.3"><meta data-rh="true" name="docusaurus_tag" content="docs-default-4.3"><meta data-rh="true" name="docsearch:version" content="4.3"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-4.3"><meta data-rh="true" property="og:title" content="xAPI (Experience API) | Moodle Developer Resources"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/moodledevdocs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://noeldemartin.github.io/moodledevdocs/docs/4.3/apis/subsystems/xapi"><link data-rh="true" rel="alternate" href="https://noeldemartin.github.io/moodledevdocs/docs/4.3/apis/subsystems/xapi" hreflang="en-AU"><link data-rh="true" rel="alternate" href="https://noeldemartin.github.io/moodledevdocs/docs/4.3/apis/subsystems/xapi" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NNUY2D5GV2-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L9EE8RW5B1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-L9EE8RW5B1",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Moodle Developer Resources" href="/moodledevdocs/opensearch.xml">

<link rel="icon" href="/moodledevdocs/img/icons/orange_m.svg">
<link rel="manifest" href="/moodledevdocs/manifest.json">
<meta name="theme-color" content="rgb(208, 99, 0)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/moodledevdocs/img/icons/maskable_icon.png">
<link rel="mask-icon" href="/moodledevdocs/img/icons/maskable_icon.png" color="rgb(208, 99, 0)">
<meta name="msapplication-TileImage" content="/moodledevdocs/img/icons/maskable_icon.png">
<meta name="msapplication-TileColor" content="#000">

<script src="https://zipchat.ai/widget/zipchat.js?id=gQKDVDpI9xQWW4n04W4K" defer="defer"></script><link rel="stylesheet" href="/moodledevdocs/assets/css/styles.cca56588.css">
<script src="/moodledevdocs/assets/js/runtime~main.29916bfb.js" defer="defer"></script>
<script src="/moodledevdocs/assets/js/main.63ca6e29.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="moodlesitestopnavbar_Frnu"><button class="mobile_menu_jwKm" type="button" aria-label="Toggle navigation"><span class="fa_waffle_mobile_mW1T"></span></button><a href="https://moodle.org" class="navbar-brand position-lg-fixed d-none d-lg-flex align-items-center m-0 p-0 aabtn"><img src="https://moodle.org/theme/moodleorg/pix/moodle_logo_TM.svg" class="nav_logo_TBny" height="32px" alt="Moodle.org"></a><div class="navbar_wrapper_BLET" id="navbar_wrapper"><ul class="navbar_nav_t6hh"><li><a class="nav_link_MbBP" href="https://moodle.org/course"><span>Forums</span></a></li><li><a class="nav_link_MbBP" href="https://docs.moodle.org"><span>Documentation</span></a></li><li><a class="nav_link_MbBP" href="https://download.moodle.org"><span>Downloads</span></a></li><li><a class="nav_link_MbBP" href="https://moodle.org/demo"><span>Demo</span></a></li><li><a class="nav_link_MbBP" href="https://tracker.moodle.org"><span>Tracker</span></a></li><li><a class="nav_link_MbBP" href="https://moodledev.io/"><span>Development</span></a></li><li><a class="nav_link_MbBP" href="https://lang.moodle.org"><span>Translation</span></a></li><div class="extra_links_K5sj"><hr height="8px" style="margin:0.5rem"><li><a class="nav_link_MbBP" href="https://moodle.org/public/search"><i class="fa_search_d6Q5" style="margin-right:0.5rem"></i>Search</a></li><li><button class="nav_link_MbBP" type="button"><i class="fa_waffle_HYQ3" style="margin-right:0.5rem"></i>Moodle Sites<i class="fa_arrow_r_hbkJ" style="margin-left:1rem"></i></button></li></div><li class="search_bDdD"><a class="nav_link_MbBP" href="https://moodle.org/public/search" aria-label="Search moodle.org"><i class="fa_search_d6Q5"></i></a></li><li class="waffle_SC1o"><button class="nav_link_MbBP" type="button" aria-label="Toggle sites menu"><i class="fa_waffle_HYQ3"></i></button></li><div class="moodle_sites_pA64" id="waffle_menu"><div class="pathways_Gtf7"><div class="heading_y6w7">What are you looking for?</div><hr><p>Learn about Moodle&#x27;s products, like Moodle LMS or Moodle Worplace, or find a Moodle Certified Service Provider.<br><br><a href="https://moodle.com">Moodle.com<!-- --> <i class="fa fa-long-arrow-right icon"></i></a></p><hr><p>Our social network to share and curate open educational resources.<br><br><a href="https://moodle.net">MoodleNet<!-- --> <i class="fa fa-long-arrow-right icon"></i></a></p><hr><p>Courses and programs to develop your skills as a Moodle educator, administrator, designer or developer.<br><br><a href="https://moodle.academy">Moodle Academy<!-- --> <i class="fa fa-long-arrow-right icon"></i></a></p></div></div></ul><ul class="sites_nav_zUr9" id="sites-nav"><button class="nav_link_MbBP" type="button" aria-label="Close sites menu"><i class="fa_arrow_left_jgS9" style="margin-left:-0.6rem"></i></button><div class="pt-2 pathways"><p><a href="https://moodle.com">Moodle.com</a><br>Learn about Moodle&#x27;s products, like Moodle LMS or Moodle Worplace, or find a Moodle Certified Service Provider.<br></p><hr><p><a href="https://moodle.net">MoodleNet</a><br>Our social network to share and curate open educational resources.<br></p><hr><p><a href="https://moodle.academy">Moodle Academy</a><br>Courses and programs to develop your skills as a Moodle educator, administrator, designer or developer.<br></p></div></ul></div></nav><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__item navbar__link" href="/moodledevdocs/docs/4.4">Guides</a><a class="navbar__item navbar__link" href="/moodledevdocs/general/community/contribute">Community</a><a class="navbar__item navbar__link" href="/moodledevdocs/general/development/gettingstarted">Coding</a><a class="navbar__item navbar__link" href="/moodledevdocs/general/development/process">Process</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/moodledevdocs/docs/4.3">4.3</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/moodledevdocs/docs/4.4/apis/subsystems/xapi">main</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/moodledevdocs/docs/4.3/apis/subsystems/xapi">4.3</a></li><li><a class="dropdown__link" href="/moodledevdocs/docs/4.2/apis/subsystems/xapi">4.2</a></li><li><a class="dropdown__link" href="/moodledevdocs/docs/4.1">4.1</a></li><li><a href="https://docs.moodle.org/dev/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Legacy documentation<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/moodledevdocs/versions">All versions</a></li></ul></div><div class="wrapper_Jz6K"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/moodledevdocs/docs/4.3">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/moodledevdocs/docs/4.3/guides">Developer guides</a><button aria-label="Expand sidebar category &#x27;Developer guides&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/moodledevdocs/docs/4.3/apis">API guides</a><button aria-label="Collapse sidebar category &#x27;API guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/commonfiles">Common files</a><button aria-label="Expand sidebar category &#x27;Common files&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/core">Core APIs</a><button aria-label="Expand sidebar category &#x27;Core APIs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/plugintypes">Plugin types</a><button aria-label="Expand sidebar category &#x27;Plugin types&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/moodledevdocs/docs/4.3/category/subsystems">Subsystems</a><button aria-label="Collapse sidebar category &#x27;Subsystems&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/access">Access API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/admin">Admin settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/analytics">Analytics API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/availability">Availability API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/backup">Backup API</a><button aria-label="Expand sidebar category &#x27;Backup API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/check">Check API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/communication">Communication API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/editor">Editor API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/enrol">Enrolment API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/external">External Services</a><button aria-label="Expand sidebar category &#x27;External Services&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/favourites">Favourites API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/files">File API</a><button aria-label="Expand sidebar category &#x27;File API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/form">Forms API</a><button aria-label="Expand sidebar category &#x27;Forms API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/group">Groups API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/output">Output API</a><button aria-label="Expand sidebar category &#x27;Output API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/plagiarism">Plagiarism API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/privacy">Privacy API</a><button aria-label="Expand sidebar category &#x27;Privacy API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/roles">Roles API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/tag">Tag API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/task">Task API</a><button aria-label="Expand sidebar category &#x27;Task API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/time">Time API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/moodledevdocs/docs/4.3/apis/subsystems/xapi">xAPI (Experience API)</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/moodledevdocs/general/contentguidelines">Content guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/moodledevdocs/docs/4.3/devupdate">Developer update</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/moodledevdocs/general/app">Moodle App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><hr></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/moodledevdocs/general/releases/4.3">Release notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/moodledevdocs/general/projects">Projects</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/moodledevdocs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/moodledevdocs/docs/4.3/apis"><span itemprop="name">API guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/moodledevdocs/docs/4.3/category/subsystems"><span itemprop="name">Subsystems</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">xAPI (Experience API)</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 4.3</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>xAPI (Experience API)</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>This document contains a technical explanation on how the xAPI Moodle integration library works.</p>
<p>The <strong>Experience API (xAPI)</strong> is an e-learning software specification that allows learning content and learning systems to speak to each other in a manner that records and tracks all types of learning experiences.</p>
<p>xAPI defines web services that can be used by any plugin or application to connect to the LMS in a standard way. The main actors in xAPI communication are:</p>
<ul>
<li><strong>Client</strong>: any plugin or application that wants to use xAPI webservices</li>
<li><strong>xAPI LRS</strong> (server site): responsible for storing and serving the data emitted by the clients</li>
</ul>
<p>The xAPI LRS specification implements six endpoints:</p>
<ul>
<li>The <code>Statement Endpoint</code> is used for all xAPI statements. One good aspect about xAPI is that the amount of messages that can be shared between the clients and the LRS is quite limited. The main message type is called <strong>Statement</strong> and all statements can be summarized as &quot;<em>An actor XX executes action YY on object ZZ</em>&quot;.</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The typical statement object is a JSON element containing:</p><ul>
<li><strong>Actor</strong>: the person or group that do something</li>
<li><strong>Verb</strong>: the action the Actor do</li>
<li><strong>Object</strong>: the object on the Verb is executed. There are more than one type of objects that can be defined here but, for now, you can think about it as a specific &quot;Quiz Attempt&quot; for example.</li>
<li>Other fields: for now, the rest of xAPI fields have a basic data validation so every plugin is responsible for implementing it&#x27;s own checks if they need them.</li>
</ul></div></div>
<ul>
<li>The <code>About Resource Endpoint</code> returns metadata about the LRS (for instance, the xAPI version or LRS configuration details).</li>
<li>The <code>Activities Endpoint</code> returns metadata about a particular, unique activity. &quot;Unique activities&quot; may be, for example, different online courses, and their metadata might include their titles, descriptions, and usage instructions.</li>
<li>The <code>Agents Endpoint</code> returns metadata about a particular agent. An &quot;agent&quot; may be a learner or class cohort, for example.</li>
<li>Three endpoints fall under the <code>Document Endpoints</code> category; these endpoints all involve user-defined key-value pairs, which are typically unique to a given system. The Document Endpoints are primarily used by (local) Learning Activity Providers. The data stored in these endpoints represent the current situation at a given time, and those data can be updated (replacing old data) if/when the current situation changes.<!-- -->
<ul>
<li>The <code>Agent Profile Endpoint</code> allows the storage and return of universal data about a particular user (for instance, the learner&#x27;s preferred language, accessibility preferences such as closed captioning).</li>
<li>The <code>Activity Profile</code> allows the storage and return of universal data about a particular activity (for instance, minimum required score, time limit, what happens if the time limit is exceeded).</li>
<li>The <code>State Endpoint</code> allows the storage and return of data about the current state of an activity for a particular learner (for instance, bookmark, state of play of the simulation, other state variables). In other words, the State Endpoint stores data about an activity/agent combination.</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>xAPI specification</div><div class="admonitionContent_BuS1"><p>The xAPI specification can be consulted in the xAPI specs page: <a href="https://github.com/adlnet/xAPI-Spec" target="_blank" rel="noopener noreferrer">https://github.com/adlnet/xAPI-Spec</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="moodle-xapi-functionalities">Moodle xAPI functionalities<a href="#moodle-xapi-functionalities" class="hash-link" aria-label="Direct link to Moodle xAPI functionalities" title="Direct link to Moodle xAPI functionalities">​</a></h2>
<p>The final objective of Moodle xAPI library is NOT to implement a full LRS inside Moodle but to provide an easy way to handle xAPI statements and xAPI states within any plugin that needs it.</p>
<p>Moodle supports the main xAPI request which is called &quot;<strong>statement</strong>&quot; and, from Moodle 4.2 onwards, also supports <strong>state</strong>:</p>
<ul>
<li>A statement must be seen as a tracking message that can be used by any plugin to store user activity directly in Moodle without programming any additional web service.</li>
<li>A state should be used to store the user progressing in the play.</li>
</ul>
<p>The current library implements:</p>
<ul>
<li>New webservices:<!-- -->
<ul>
<li><strong>core_xapi_statement_post</strong> to process xAPI statements and generate standard Moodle events.</li>
<li><strong>core_xapi_post_state</strong> to store a xAPI state.</li>
<li><strong>core_xapi_get_state</strong> to get an xAPI state data.</li>
<li><strong>core_xapi_delete_state</strong> to remove a xAPI state.</li>
</ul>
</li>
<li>A class <strong>\core_xapi\handler</strong> that any plugin can extend in order to use xAPI and generate specific plugin contexts. This way, any plugin could use xAPI without implementing any new web service.</li>
<li>A class <strong>\core_xapi\iri</strong> to easily translate random information into valid <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Data.md#43-iris" target="_blank" rel="noopener noreferrer">IRI (Internationalized Resource Identifiers)</a> values (needed for xAPI objects and verbs)</li>
<li>A class <strong>\core_xapi\local\statement</strong> to create and extract information from statement data.</li>
<li>A class <strong>\core_xapi\local\state</strong> to create and extract information from state data.</li>
<li>A bunch of predefined classes in <strong>\core_xapi\local\statement\item_XXX</strong> to generate xAPI statement items from the plugins (example provided in <a href="#generating-statements-in-php">Generating statements in PHP</a>).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="statement-api">Statement API<a href="#statement-api" class="hash-link" aria-label="Direct link to Statement API" title="Direct link to Statement API">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="statement-processing">Statement processing<a href="#statement-processing" class="hash-link" aria-label="Direct link to Statement processing" title="Direct link to Statement processing">​</a></h3>
<p>The <code>core_xapi_statement_post</code> webservice receives a JSON encoded statement (could be an array or a single one) and a component frankenstyle name.</p>
<p>The processing sequence is:</p>
<ol>
<li>The core xAPI library checks if the specified component has a xAPI handling class implementation. Otherwise it returns an error.</li>
<li>xAPI checks the statement structure, if any check fails, it returns an error. The main validations for now are:<!-- -->
<ol>
<li>Check that only supported xAPI attributes are used. If the statement array has some format error all statements will be rejected (see <a href="#statement-data-validation">Statement data validation</a> for more information).</li>
<li>Check all users and groups are created in the LMS.</li>
<li>Check the current user ($USER) is an actor of the statement (actors can be a single agent or a group).</li>
</ol>
</li>
<li>For every statement:<!-- -->
<ol>
<li>xAPI asks the component handler to convert the statement into a standard event (function <code>statement_to_event()</code>). In case the plugin could not convert some statement into an event, this statement will be marked as &quot;not processed&quot; and will continue to the next statement.</li>
<li>xAPI triggers the generated events.</li>
</ol>
</li>
<li>Once all statements are processed:<!-- -->
<ol>
<li>If ALL statements are marked as &quot;not processed&quot; it returns an error.</li>
<li>If some statement could be processed, returns an array containing &quot;true&quot; if the statement is processed and &quot;false&quot; otherwise.</li>
</ol>
</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The function <code>statement_to_event()</code> is responsible for:</p><ul>
<li>Asserting that the specified user has permission to execute that statement.</li>
<li>Providing a valid Moodle event to trigger</li>
<li>Processing any result attached to the statement</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="statement-data-validation">Statement data validation<a href="#statement-data-validation" class="hash-link" aria-label="Direct link to Statement data validation" title="Direct link to Statement data validation">​</a></h3>
<p>The <code>core_xapi_statement_post</code> webservice will reject any statements batch that does not comply with the below xAPI data validation:</p>
<ul>
<li><strong>actor</strong>: this is a mandatory field. Actor objectType attribute must be &quot;Agent&quot; or &quot;Group&quot;<!-- -->
<ul>
<li><strong>agent</strong>: agent can be only real Moodle users and must be identified by <code>account</code> (user id as name and wwwroot as homepage) or <code>mbox</code> (user email). The other agent identifiers are not supported (<code>mbox_sha1sum</code> and <code>openid</code>).</li>
<li><strong>group</strong>: all groups must be real Moodle groups identified by <code>account</code> (group id as name and wwwroot as homepage). Anonymous groups are not supported.</li>
</ul>
</li>
<li><strong>verb</strong>: this is a mandatory field. Verb id must be provided in a valid IRI format.</li>
<li><strong>object</strong>: this is a mandatory field. The objectType attribute can be &quot;Agent&quot;, &quot;Group&quot; ar &quot;Activity&quot;:<!-- -->
<ul>
<li><strong>agent</strong> or <strong>group</strong>: both have the same restrictions as when they act as actors.</li>
<li><strong>activity</strong>: activity id must be provided as a valid IRI format.<!-- -->
<ul>
<li><strong>definition</strong>: in case a definition is provided, the only accepted interaction types are: <code>choice</code>, <code>fill-in</code>, <code>long-fill-in</code>, <code>true-false</code>, <code>matching</code>, <code>performance</code>, <code>sequencing</code>, <code>likert</code>, <code>numeric</code>, <code>compound</code> and <code>other</code>.</li>
</ul>
</li>
</ul>
</li>
<li><strong>result</strong>: in case it is provided the duration must be provided in a valid <code>ISO 8601</code> compatible with the PHP <code>DateInterval</code> class (More info: <a href="https://bugs.php.net/bug.php?id=53831" target="_blank" rel="noopener noreferrer">https://bugs.php.net/bug.php?id=53831</a>).<!-- -->
<ul>
<li><strong>score</strong>: all score fields are optional and do not have any particular data validation.</li>
</ul>
</li>
<li><strong>context</strong>: it has no specific validation.</li>
<li><strong>attachments</strong>: if present must be an array of elements and every element must have: usageType, display, contentType, a valid usageType IRI, a numeric length and a sha2.</li>
<li><strong>authority</strong>: must be a valid xAPI actor.</li>
<li><strong>timestamp</strong>, <strong>stored</strong> and <strong>version</strong>: those optional fields are just strings with no particular validation or usage for now.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="generating-statements-in-php">Generating statements in PHP<a href="#generating-statements-in-php" class="hash-link" aria-label="Direct link to Generating statements in PHP" title="Direct link to Generating statements in PHP">​</a></h3>
<p>The xAPI library provides classes to translate Moodle elements into xAPI structures. Those statements could be sent to JS via the <code>$PAGE-&gt;requires-&gt;data_for_js</code> method.</p>
<p>The next example shows how to generate a basic statement:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Generate a basic statement</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_actor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_verb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_activity</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Generate statement.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">statement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">set_actor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name static-context">item_agent</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$USER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">set_verb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name static-context">item_verb</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;bake&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">set_object</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name static-context">item_activity</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;cake&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As can be seen in the example, the class <code>item_agent</code> has a static method to generate a valid xAPI actor from a user record. The result object of executing that code will be something like:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;actor&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;objectType&quot;: &quot;Agent&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;account&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;homePage&quot;: &quot;http:\/\/localhost\/m\/H5P&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;verb&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;id&quot;: &quot;http:\/\/localhost\/m\/H5P\/xapi\/verb\/bake&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;object&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;objectType&quot;: &quot;Activity&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;id&quot;: &quot;http:\/\/localhost\/m\/H5P\/xapi\/object\/cake&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For the object and verbs, xAPI uses a standard IRI format. The xAPI library will convert any string into a valid IRI but it can also use real IRI identifiers to generate standard verbs and object structures.</p>
<p>The next example is more a less the same but using valid IRI values for verbs and objects:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Example using valid IRI values for verbs and objects</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_actor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_verb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_activity</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Generate statement.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">statement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">set_actor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name static-context">item_agent</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$USER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">set_verb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name static-context">item_verb</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;http://adlnet.gov/xapi/verbs/bake&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">set_object</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name static-context">item_activity</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;http://adlnet.gov/xapi/activities/cake&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The resulting structure will be:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;actor&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;objectType&quot;: &quot;Agent&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;account&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;homePage&quot;: &quot;http:\/\/localhost\/m\/H5P&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;verb&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;id&quot;: &quot;http:\/\/adlnet.gov\/xapi\/verbs\/bake&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;object&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;objectType&quot;: &quot;Activity&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;id&quot;: &quot;http:\/\/adlnet.gov\/xapi\/activities\/cake&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The xAPI library also provides classes to convert Moodle groups into valid xAPI group actors. To generate one the code is as following:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Conver Moodle groups into valid xAPI group actors</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_actor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_verb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_activity</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Generate statement.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$group</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">groups_get_group</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$groupid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">statement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">set_actor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name static-context">item_group</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_group</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$group</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">set_verb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name static-context">item_verb</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;bake&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$statement</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">set_object</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name static-context">item_activity</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;cake&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The result will be:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;actor&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;objectType&quot;: &quot;Group&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;name&quot;: &quot;Group A&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;account&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;homePage&quot;: &quot;http:\/\/localhost\/m\/H5P&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot;: &quot;1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;verb&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;id&quot;: &quot;http:\/\/localhost\/m\/H5P\/xapi\/verb\/bake&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;object&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;objectType&quot;: &quot;Activity&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;id&quot;: &quot;http:\/\/localhost\/m\/H5P\/xapi\/object\/cake&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="xapi-statements-attributes-implementation">xAPI statements attributes implementation<a href="#xapi-statements-attributes-implementation" class="hash-link" aria-label="Direct link to xAPI statements attributes implementation" title="Direct link to xAPI statements attributes implementation">​</a></h3>
<p>All xAPI statement attributes have its own implementation in case any plugin needs them. All classes are implemented in the namespace <code>core_xapi\local\statement</code>, Those are the classes implemented:</p>
<ul>
<li><strong>Item</strong>: all xAPI attributes derived from this class. This class provides a method to generate a valid item from a xAPI data structure (<code>create_from_data</code>), implements JSON serialization and provides the basic <code>get_data</code> method to access the raw element data structure.<!-- -->
<ul>
<li><strong>Item_actor</strong>: this is an abstract class extended by both two xAPI valid actors:<!-- -->
<ul>
<li><strong>Item_agent</strong>: an individual user. The class has a static method called <code>create_from_user</code> to generate a valid xAPI actor from a moodle user record.</li>
<li><strong>Item_group</strong>: a group statement. Moodle xAPI implementation only accepts named groups (it will reject any anonymous group). To generate a valid xAPI group from a Moodle group the class has a static method called <code>create_from_group</code>. It also provides methods to get all Moodle users from that group (<code>get_all_users</code>) and the group record itself (<code>get_group</code>).</li>
</ul>
</li>
<li><strong>Item_verb</strong>: represents the statement verb. The class has a static method <code>create_from_id</code> which accepts both valid IRI values or any random string to create a valid xAPI verb structure. It also has a method to get back the verb value (<code>get_id</code>).</li>
<li><strong>Item_object</strong>: this is an abstract class extended by all possible xAPI valid objects:<!-- -->
<ul>
<li><strong>Item_agent</strong> or <strong>Item_group</strong>: both can be statements actor or objects as well</li>
<li><strong>Item_activity</strong>: activity can be any kind of string value which the plugin decides. It has the same methods as item_verb to create and get this value (<code>create_from_id</code> and <code>get_id</code>). The xAPI activity could have also an attribute called <code>definition</code> that contains a SCORM like data defining the user interaction.<!-- -->
<ul>
<li><strong>Item_definition</strong>: contains all the specific interaction details such as the interaction type (in SCORM format), the user answer or the correct answer pattern.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Item_result</strong>: this optional attribute represents any kind of results and score derived from the user interaction. It has no strict data validation and it has to be created directly from a valid xAPI data structure using the method <code>create_from_data</code>. It provides two methods to get the result score if present (<code>get_score</code>) and one to convert the result duration into seconds (<code>get_duration</code>). It uses also one subclass to handle score:</li>
<li><strong>Item_score</strong>: the class representing the xAPI score data. It has no validation and no specific methods.</li>
<li><strong>Item_context</strong>: the class representing the xAPI context data. It has no validation and no specific methods.</li>
<li><strong>Item_attachment</strong>: validate the xAPI attachment structure</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="adapting-a-plugin-to-use-xapi-statement-functions">Adapting a plugin to use xAPI statement functions<a href="#adapting-a-plugin-to-use-xapi-statement-functions" class="hash-link" aria-label="Direct link to Adapting a plugin to use xAPI statement functions" title="Direct link to Adapting a plugin to use xAPI statement functions">​</a></h3>
<p>All the plugins could use the new xAPI functionalities to send xAPI statements, interact with them, trigger events and generate log store entries.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-implement-a-xapi-handle-class">Step 1. Implement a xAPI handle class<a href="#step-1-implement-a-xapi-handle-class" class="hash-link" aria-label="Direct link to Step 1. Implement a xAPI handle class" title="Direct link to Step 1. Implement a xAPI handle class">​</a></h4>
<p>Implement a class <code>\PLUGINNAME\classes\xapi\handler</code> which extends <code>\core_xapi\handler</code> and override these methods:</p>
<ul>
<li><code>statement_to_event(statement $statement): core\event\base</code>: to convert a statement into a valid Moodle event</li>
<li><code>supports_group_actors(): bool</code>: in case that the plugin wants to accept also Group statements (by default any Group statement will be rejected) it can override this method.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-implement-events">Step 2. Implement events<a href="#step-2-implement-events" class="hash-link" aria-label="Direct link to Step 2. Implement events" title="Direct link to Step 2. Implement events">​</a></h4>
<p>All xAPI statements MUST be converted into a valid Moodle event. So the plugin needs to <strong>code all the necessary events</strong> for this.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="useful-methods-to-handle-xapi-statements-inside-plugins">Useful methods to handle xAPI statements inside plugins<a href="#useful-methods-to-handle-xapi-statements-inside-plugins" class="hash-link" aria-label="Direct link to Useful methods to handle xAPI statements inside plugins" title="Direct link to Useful methods to handle xAPI statements inside plugins">​</a></h3>
<p>The <code>core_xapi\local\statement</code> provides several methods to extract information from a statement object.</p>
<ul>
<li>
<p><code>get_user (): stdClass</code></p>
<p>Return the Moodle user represented by the statement actor. In the case of a group actor, this function will throw an xapi_exception.</p>
</li>
<li>
<p><code>get_all_users(): array</code></p>
<p>Will return an array with all Moodle users represented in the xAPI actor object. This can be used in both single agent and group statements.</p>
</li>
<li>
<p><code>get_group(): stdClass</code></p>
<p>Return the Moodle group record represented in the xAPI actor. In the case of a single agent actor, this function will throw an xapi_exception.</p>
</li>
<li>
<p><code>get_verb_id (): string</code></p>
<p>Return the current verb ID value from a statement.</p>
</li>
<li>
<p><code>get_activity_id(): string</code></p>
<p>Return the current activity ID. If the statement object is not an activity (could be also an agent or a group) the method will throw an <code>xapi_exception</code>.</p>
</li>
<li>
<p><code>minify (): ?array</code></p>
<p>Return a minified version of the statement suitable for using as a &quot;other&quot; field of a Moodle event.</p>
</li>
<li>
<p><code>get_actor(): item_actor</code></p>
<p>Return the statement actor.</p>
</li>
<li>
<p><code>get_verb(): item_verb</code></p>
<p>Return the statement verb.</p>
</li>
<li>
<p><code>get_object(): item_object</code></p>
<p>Return the statement object.</p>
</li>
<li>
<p><code>get_context(): item_context</code></p>
<p>Return the statement context attribute.</p>
</li>
<li>
<p><code>get_result(): item_result</code></p>
<p>Return the statement result attribute.</p>
</li>
<li>
<p><code>get_timestamp(): string</code></p>
<p>Return the statement timestamp attribute.</p>
</li>
<li>
<p><code>get_stored(): string</code></p>
<p>Return the statement stored attribute.</p>
</li>
<li>
<p><code>get_authority(): item_actor</code></p>
<p>Return the statement authority attribute.</p>
</li>
<li>
<p><code>get_version(): string</code></p>
<p>Return the statement version attribute.</p>
</li>
<li>
<p><code>get_attachments(): item_attachment</code></p>
<p>Return the statement attachments attribute.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-ajax-lib-to-send-a-statement-to-moodle">Using Ajax lib to send a statement to Moodle<a href="#using-ajax-lib-to-send-a-statement-to-moodle" class="hash-link" aria-label="Direct link to Using Ajax lib to send a statement to Moodle" title="Direct link to Using Ajax lib to send a statement to Moodle">​</a></h3>
<p>The webservices have a different behaviour depending if it is processing a single statement or an array of them.</p>
<p>This code could be an example of a single xAPI statement post JavaScript code:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Post single xAPI statement with JavaScript</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;core/ajax&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">ajax</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">component</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;mod_h5p&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">requestjson</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">statement</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> promises </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ajax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token literal-property property" style="color:#36acaa">methodname</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;core_xapi_statement_post&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token literal-property property" style="color:#36acaa">args</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    promises</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">done</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Put some success messages...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">fail</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">ex</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Do some failure message handling...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>On the other hand, if you send more than one statement, the webservice will return an array of booleans indicating which statements are successfully stored and which not. Only in the case of none of the statements could be processed (usually because of an invalid statement structure) the webservice will return an error.</p>
<p>This could be an example of sending more than one statement to Moodle:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Post more than one xAPI statements with JavaScript</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;core/ajax&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">ajax</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">component</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;mod_h5p&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">requestjson</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">statements</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> promises </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ajax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">methodname</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;core_xapi_statement_post&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">args</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    promises</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">done</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Check if it&#x27;s a success or not.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic">// Do some success handling.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic">// Do some failure handling.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">fail</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">ex</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// None of the statements are processed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="state-api">State API<a href="#state-api" class="hash-link" aria-label="Direct link to State API" title="Direct link to State API">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="state-processing">State processing<a href="#state-processing" class="hash-link" aria-label="Direct link to State processing" title="Direct link to State processing">​</a></h3>
<p>There are three webservices to process xAPI states:</p>
<ul>
<li><code>core_xapi_post_state</code> receives a activityId, agent, stateId, registration, stateData (JSON encoded state) and a component frankenstyle name.</li>
<li><code>core_xapi_get_state</code> returns the JSON encoded state associated to the given activityId, agent, stateId, registration and component.</li>
<li><code>core_xapi_delete_state</code> removes the state with the given activityId, agent, stateId, registration and component.</li>
</ul>
<p>The processing sequence is:</p>
<ol>
<li>The core xAPI library checks if the specified component has a xAPI handling class implementation. Otherwise it returns an error.</li>
<li>xAPI checks the state structure, if any check fails, it returns an error. The main validations for now are:<!-- -->
<ol>
<li>Check the current user ($USER) is an actor of the state. If it&#x27;s not, a <code>xapi_exception</code> is thrown.</li>
<li>xAPI asks the component handler to validate state (function <code>validate_state()</code>). In case the plugin returns false, a <code>xapi_exception</code> is thrown.</li>
</ol>
</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The function <code>validate_state()</code> is responsible for asserting that the specified user has permission to execute that state.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="generating-states-in-php">Generating states in PHP<a href="#generating-states-in-php" class="hash-link" aria-label="Direct link to Generating states in PHP" title="Direct link to Generating states in PHP">​</a></h3>
<p>The xAPI library provides classes to translate Moodle elements into xAPI states. They could be sent to JS via the <code>$PAGE-&gt;requires-&gt;data_for_js</code> method.</p>
<p>The next example shows how to generate a basic state:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Generate a basic state</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">state</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_agent</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token package">core_xapi</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">local</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">statement</span><span class="token package punctuation" style="color:#393A34">\</span><span class="token package">item_activity</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Generate state.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$state</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name static-context">item_agent</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$USER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name static-context">item_activity</span><span class="token operator" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">create_from_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;cake&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$stateid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$statedata</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$registration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="adapting-a-plugin-to-use-xapi-state-functions">Adapting a plugin to use xAPI state functions<a href="#adapting-a-plugin-to-use-xapi-state-functions" class="hash-link" aria-label="Direct link to Adapting a plugin to use xAPI state functions" title="Direct link to Adapting a plugin to use xAPI state functions">​</a></h3>
<p>All the plugins could use the new xAPI functionalities to send/get/remove xAPI states.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="implement-a-xapi-handle-class">Implement a xAPI handle class<a href="#implement-a-xapi-handle-class" class="hash-link" aria-label="Direct link to Implement a xAPI handle class" title="Direct link to Implement a xAPI handle class">​</a></h4>
<p>Implement a class <code>\PLUGINNAME\classes\xapi\handler</code> which extends <code>\core_xapi\handler</code> and override this method:</p>
<ul>
<li><code>validate_state(state $state): bool</code>: to check if the state is valid for this handler. It must be implemented by the plugins which want to use xAPI states.</li>
</ul>
<p>Apart from this, a <code>core_xapi\state_store</code> class has been added to let plugins override where the states are saved. By default, they are stored in the <code>xapi_states</code> table.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="useful-methods-to-handle-xapi-states-inside-plugins">Useful methods to handle xAPI states inside plugins<a href="#useful-methods-to-handle-xapi-states-inside-plugins" class="hash-link" aria-label="Direct link to Useful methods to handle xAPI states inside plugins" title="Direct link to Useful methods to handle xAPI states inside plugins">​</a></h3>
<p>The <code>core_xapi\local\state</code> provides several methods to extract information from a state object.</p>
<p>Apart from this, <code>core_xapi\api</code> also implements several helper methods to be called from the plugins:</p>
<ul>
<li><code>remove_states_from_component(string $component): void</code>, to delete all states associated with a component.</li>
<li><code>execute_state_cleanup(): void</code>, to remove all the states for all the compatible components.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-ajax-lib-to-send-a-state-to-moodle">Using Ajax lib to send a state to Moodle<a href="#using-ajax-lib-to-send-a-state-to-moodle" class="hash-link" aria-label="Direct link to Using Ajax lib to send a state to Moodle" title="Direct link to Using Ajax lib to send a state to Moodle">​</a></h3>
<p>This code could be an example of a single xAPI state post JavaScript code:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Post single xAPI state with JavaScript</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * Send a xAPI state to LMS.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">{</span><span class="token doc-comment comment class-name" style="color:#999988;font-style:italic">string</span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">}</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">component</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">{</span><span class="token doc-comment comment class-name" style="color:#999988;font-style:italic">string</span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">}</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">activityId</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">{</span><span class="token doc-comment comment class-name" style="color:#999988;font-style:italic">Object</span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">}</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">agent</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">{</span><span class="token doc-comment comment class-name" style="color:#999988;font-style:italic">string</span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">}</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">stateId</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@param</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">{</span><span class="token doc-comment comment class-name" style="color:#999988;font-style:italic">string</span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">}</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment parameter" style="color:#999988;font-style:italic">stateData</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     * </span><span class="token doc-comment comment keyword" style="color:#00009f;font-style:italic">@returns</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"> </span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">{</span><span class="token doc-comment comment class-name keyword" style="color:#00009f;font-style:italic">void</span><span class="token doc-comment comment class-name punctuation" style="color:#393A34;font-style:italic">}</span><span class="token doc-comment comment" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">postState</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token parameter">component</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">        activityId</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">        agent</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">        stateId</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">        stateData</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> repositoryPromise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter maybe-class-name">Repository</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token maybe-class-name">Repository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">postState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        activityId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        agent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stateId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stateData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Please note that <code>core_h5p/repository</code> module in <code>h5p/amd/src/repository.js</code> has been created to handle AJAX interactions.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/moodledevdocs/docs/4.3/tags/api">API</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/moodledevdocs/docs/4.3/tags/core-xapi">core_xapi</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/moodle/devdocs/edit/main/versioned_docs/version-4.3/apis/subsystems/xapi/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-10-20T09:53:21.000Z" itemprop="dateModified">20 Oct 2023</time></b> by <b>Sara Arjona</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/moodledevdocs/docs/4.3/apis/subsystems/time"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Time API</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/moodledevdocs/docs/4.3/devupdate"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Moodle 4.3 developer update</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#moodle-xapi-functionalities" class="table-of-contents__link toc-highlight">Moodle xAPI functionalities</a></li><li><a href="#statement-api" class="table-of-contents__link toc-highlight">Statement API</a><ul><li><a href="#statement-processing" class="table-of-contents__link toc-highlight">Statement processing</a></li><li><a href="#statement-data-validation" class="table-of-contents__link toc-highlight">Statement data validation</a></li><li><a href="#generating-statements-in-php" class="table-of-contents__link toc-highlight">Generating statements in PHP</a></li><li><a href="#xapi-statements-attributes-implementation" class="table-of-contents__link toc-highlight">xAPI statements attributes implementation</a></li><li><a href="#adapting-a-plugin-to-use-xapi-statement-functions" class="table-of-contents__link toc-highlight">Adapting a plugin to use xAPI statement functions</a></li><li><a href="#useful-methods-to-handle-xapi-statements-inside-plugins" class="table-of-contents__link toc-highlight">Useful methods to handle xAPI statements inside plugins</a></li><li><a href="#using-ajax-lib-to-send-a-statement-to-moodle" class="table-of-contents__link toc-highlight">Using Ajax lib to send a statement to Moodle</a></li></ul></li><li><a href="#state-api" class="table-of-contents__link toc-highlight">State API</a><ul><li><a href="#state-processing" class="table-of-contents__link toc-highlight">State processing</a></li><li><a href="#generating-states-in-php" class="table-of-contents__link toc-highlight">Generating states in PHP</a></li><li><a href="#adapting-a-plugin-to-use-xapi-state-functions" class="table-of-contents__link toc-highlight">Adapting a plugin to use xAPI state functions</a></li><li><a href="#useful-methods-to-handle-xapi-states-inside-plugins" class="table-of-contents__link toc-highlight">Useful methods to handle xAPI states inside plugins</a></li><li><a href="#using-ajax-lib-to-send-a-state-to-moodle" class="table-of-contents__link toc-highlight">Using Ajax lib to send a state to Moodle</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Moodle</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/moodledevdocs/general/releases">Release notes</a></li><li class="footer__item"><a class="footer__link-item" href="/moodledevdocs/general/projects">Projects</a></li></ul></div><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/moodledevdocs/general/documentation">Developer docs</a></li><li class="footer__item"><a href="https://docs.moodle.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">User docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.moodle.org/dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Legacy docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/moodledevdocs/general/documentation/code-of-conduct">Code of conduct</a></li><li class="footer__item"><a href="https://moodle.org/mod/forum/view.php?id=55" target="_blank" rel="noopener noreferrer" class="footer__link-item">General Developer Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/moodle" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/moodle" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item">
                    <a href="https://www.netlify.com" target="_blank" rel="noreferrer noopener" aria-label="Deploys by Netlify">
                        <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify" width="114" height="51">
                    </a>
                    </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
Copyright © 2024 Moodle Pty Ltd. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>