"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[88549],{77800:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>c});var i=n(74848),s=n(28453),o=n(78924);const a={title:"Testing",tags:["editor_tiny","tiny","Editor","Behat","Testing"]},l=void 0,r={id:"apis/plugintypes/tiny/testing",title:"Testing",description:"Testing is an important part of development and we strongly encourage you to write appropriate tests for your plugins.",source:"@site/docs/apis/plugintypes/tiny/testing.md",sourceDirName:"apis/plugintypes/tiny",slug:"/apis/plugintypes/tiny/testing",permalink:"/moodledevdocs/docs/4.4/apis/plugintypes/tiny/testing",draft:!1,unlisted:!1,editUrl:"https://github.com/moodle/devdocs/edit/main/docs/apis/plugintypes/tiny/testing.md",tags:[{label:"editor_tiny",permalink:"/moodledevdocs/docs/4.4/tags/editor-tiny"},{label:"tiny",permalink:"/moodledevdocs/docs/4.4/tags/tiny"},{label:"Editor",permalink:"/moodledevdocs/docs/4.4/tags/editor"},{label:"Behat",permalink:"/moodledevdocs/docs/4.4/tags/behat"},{label:"Testing",permalink:"/moodledevdocs/docs/4.4/tags/testing"}],version:"current",lastUpdatedBy:"Andrew Nicols",lastUpdatedAt:1674112437e3,frontMatter:{title:"Testing",tags:["editor_tiny","tiny","Editor","Behat","Testing"]},sidebar:"docs",previous:{title:"Legacy TinyMCE Editor plugins",permalink:"/moodledevdocs/docs/4.4/apis/plugintypes/tiny/legacy"},next:{title:"Subsystems",permalink:"/moodledevdocs/docs/4.4/category/subsystems"}},h={},c=[{value:"Behat",id:"behat",level:2},{value:"Tags",id:"tags",level:3},{value:"Useful steps",id:"useful-steps",level:3},{value:"Generic steps to interact with editors",id:"generic-steps-to-interact-with-editors",level:4},{value:"Setting content of a field",id:"setting-content-of-a-field",level:5},{value:"Checking the content of a field",id:"checking-the-content-of-a-field",level:5},{value:"TinyMCE specific steps",id:"tinymce-specific-steps",level:4},{value:"Working with toolbar buttons",id:"working-with-toolbar-buttons",level:5},{value:"Working with the menu bar",id:"working-with-the-menu-bar",level:5},{value:"Selecting content",id:"selecting-content",level:5},{value:"Writing your own steps",id:"writing-your-own-steps",level:3},{value:"Important notes",id:"important-notes",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.A,{frontMatter:a,metadata:r}),"\n",(0,i.jsx)(t.p,{children:"Testing is an important part of development and we strongly encourage you to write appropriate tests for your plugins."}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["When writing tests which only ",(0,i.jsx)(t.em,{children:"use"})," a text editor, and are not either tests specifically for that editor, or one of its plugins, you should attempt not to use editor-specific tests."]})}),"\n",(0,i.jsx)(t.h2,{id:"behat",children:"Behat"}),"\n",(0,i.jsx)(t.h3,{id:"tags",children:"Tags"}),"\n",(0,i.jsxs)(t.p,{children:["If you are writing a test for the TinyMCE editor, please note that your test ",(0,i.jsx)(t.strong,{children:"must"})," have one or more of the following Behat tags:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"@editor_tiny"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"@tiny_[pluginname]"})}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"By using these tags appropriately, Moodle will ensure that TinyMCE is set as the default editor for the site for the duration of your test, regardless of any other editors installed."}),"\n",(0,i.jsx)(t.h3,{id:"useful-steps",children:"Useful steps"}),"\n",(0,i.jsxs)(t.p,{children:["A number of useful Behat steps have been defined in ",(0,i.jsx)(t.a,{href:"https://github.com/moodle/moodle/blob/master/lib/editor/tiny/tests/behat/behat_editor_tiny.php",children:"TinyMCE Behat context"}),"."]}),"\n",(0,i.jsx)(t.admonition,{title:"Use generic steps where possible",type:"caution",children:(0,i.jsxs)(t.p,{children:["Typically, when interacting with an Editor, you should use the ",(0,i.jsx)(t.em,{children:"generic"})," step definitions rather than writing specific steps, or writing sequences of steps to do so."]})}),"\n",(0,i.jsx)(t.h4,{id:"generic-steps-to-interact-with-editors",children:"Generic steps to interact with editors"}),"\n",(0,i.jsxs)(t.p,{children:["Most of these steps are defined in the ",(0,i.jsx)(t.a,{href:"https://github.com/moodle/moodle/blob/master/lib/tests/behat/behat_forms.php",children:"Behat Forms context"})," and this documentation should not be treated as a complete list, rather an indication of approaches that you may consider taking."]}),"\n",(0,i.jsx)(t.h5,{id:"setting-content-of-a-field",children:"Setting content of a field"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:"title=\"Set the content of the field with the label 'Description'\"",children:'Given I set the field "Description" to "<p>Some value which includes valid HTML</p>"\nGiven I set the field "Description" to multiline:\n"""\n<p>Some value which includes valid HTML</p>\n"""\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:"title=\"Set the content of the field with the label 'Description' within the 'Create event' modal\"",children:'Given I set the field "Description" in the "Create event" "dialogue" to "<p>Some value which includes valid HTML</p>"\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:"title=\"Set the content of the field with the label 'Description' along side some other fields\"",children:"Given I set the following fields to these values:\n  | Name        | Some name here                              |\n  | Description | <p>Some value which includes valid HTML</p> |\n"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:"title=\"Set the content of the field with the label 'Description' along side some other fields within the 'Create event' modal\"",children:'Given I set the following fields in the "Create event" "dialogue" to these values:\n  | Name        | Some name here                              |\n  | Description | <p>Some value which includes valid HTML</p> |\n'})}),"\n",(0,i.jsx)(t.h5,{id:"checking-the-content-of-a-field",children:"Checking the content of a field"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:"title=\"Check that the content of the field with the label 'Description' matches a value\"",children:'Then the field "Description" matches value "<p>Some value which includes valid HTML</p>"\nThen the field "Description" matches multiline:\n"""\n<p>Some value which includes valid HTML</p>\n"""\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:"title=\"Check that the content of the field with the label 'Description' does not match a value\"",children:'Then the field "Description" does not match value "<p>Some value which includes valid HTML</p>"\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:"title=\"Check that the content of the field with the label 'Description' within the 'Create event' modal matches a value\"",children:'Then the field "Description" in the "Create event" "dialogue" matches value "<p>Some value which includes valid HTML</p>"\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:'title="Check that the content of a set of fields match values"',children:"Then the following fields match these values:\n  | Name        | Some name here                              |\n  | Description | <p>Some value which includes valid HTML</p> |\n"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:"title=\"Check that the content of a set of fields within the 'Create event' modal match values\"",children:'Then the following fields in the "Create event" "dialogue" match these values:\n  | Name        | Some name here                              |\n  | Description | <p>Some value which includes valid HTML</p> |\n'})}),"\n",(0,i.jsx)(t.h4,{id:"tinymce-specific-steps",children:"TinyMCE specific steps"}),"\n",(0,i.jsx)(t.p,{children:"If you are writing a TinyMCE plugin or feature, then you may need to interact with the editor interface, or to check and set the current value of the editor."}),"\n",(0,i.jsxs)(t.admonition,{title:"iFrames",type:"note",children:[(0,i.jsxs)(t.p,{children:["Behat makes use of WebDriver to control browsers. The WebDriver specification limits the scope of a command to the current ",(0,i.jsx)(t.em,{children:"context"})," where a context is a browser Window, Frame, or iFrame."]}),(0,i.jsxs)(t.p,{children:["TinyMCE places the Editor UI within its own iFrame. To control any of its interface, you ",(0,i.jsx)(t.em,{children:"may"})," need to switch to the iFrame for your editor first."]}),(0,i.jsx)(t.p,{children:"Most of the steps written for TinyMCE are already aware of the iFrame."})]}),"\n",(0,i.jsx)(t.h5,{id:"working-with-toolbar-buttons",children:"Working with toolbar buttons"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:'title="Expanding all toolbar buttons"',children:'Given I expand all toolbars for the "Description" TinyMCE editor\n'})}),"\n",(0,i.jsxs)(t.admonition,{type:"caution",children:[(0,i.jsx)(t.p,{children:"The default TinyMCE configuration will automatically collapse the toolbar to show as many elements as will fit on the page."}),(0,i.jsx)(t.p,{children:'You should always use the "I expand all toolbars" step before interacting with a button on the toolbar as it may not be visible in all cases.'}),(0,i.jsx)(t.p,{children:"This step is safe to call if the toolbar is already expanded, or does not need to be expanded."})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:'title="Clicking on a button for your editor"',children:'When I click on the "Bold" button for the "Description" TinyMCE editor\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:'title="Checking the state of a button in your editor"',children:'Then the "Bold" button of the "Description" TinyMCE editor has state "true"\n'})}),"\n",(0,i.jsx)(t.h5,{id:"working-with-the-menu-bar",children:"Working with the menu bar"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:'title="Clicking on a menu bar button"',children:'I click on the "Insert" menu item for the "Description" TinyMCE editor\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:'title="Clicking on a nested menu bar button"',children:'I click on the "Insert > Image" menu item for the "Description" TinyMCE editor\n'})}),"\n",(0,i.jsx)(t.h5,{id:"selecting-content",children:"Selecting content"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:'title="Selecting content by tag name and index"',children:'I select the "p" element in position "2" of the "Description" TinyMCE editor\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-gherkin",metastring:'title="Selecting content using a selector and type"',children:'I select the ".example_placeholder" "css_element" in the "Description" TinyMCE editor\n'})}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsx)(t.p,{children:"All content selection is performed within the context of the editor's own iframe. Please note that some of the standard Behat locators will not work as they expect certain elements to be present within the page body."})}),"\n",(0,i.jsx)(t.h3,{id:"writing-your-own-steps",children:"Writing your own steps"}),"\n",(0,i.jsx)(t.p,{children:"If you are writing your own steps, then we recommend that you:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:'include the name of your plugin, or "TinyMCE editor" in the wording of the step so that it is not mis-used for another purpose'}),"\n",(0,i.jsx)(t.li,{children:"check that the Feature, or Scenario, includes the frankenstyle component name for your plugin"}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",metastring:'title="Checking for a tag on your Feature or Scenario"',children:"if (!$this->has_tag('tiny_myplugin')) {\n    throw new DriverException(\n        'This step must have the @tiny_myplugin tag on either the Feature, or the Scenario.'\n    );\n}\n"})}),"\n",(0,i.jsx)(t.h3,{id:"important-notes",children:"Important notes"}),"\n",(0,i.jsxs)(t.p,{children:["Some of these steps will be improved in coming changes. See ",(0,i.jsx)(t.a,{href:"https://tracker.moodle.org/browse/MDL-75926",children:"MDL-75926"})," and ",(0,i.jsx)(t.a,{href:"https://tracker.moodle.org/browse/MDL-76853",children:"MDL-76853"})," for more information."]})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);