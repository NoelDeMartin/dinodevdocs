"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[80125],{11147:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>i,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var s=n(74848),t=n(28453),a=n(78924);const o={title:"Preference API",tags:["API","User Preferences","User"]},c=void 0,l={id:"apis/core/preference/index",title:"Preference API",description:"The Preference API is used for the storage and retrieval of user preferences. These preferences are stored in the database for users with an account, however for guests or users who are not currently logged in the preferences are stored in the Session.",source:"@site/versioned_docs/version-4.1/apis/core/preference/index.md",sourceDirName:"apis/core/preference",slug:"/apis/core/preference/",permalink:"/moodledevdocs/docs/4.1/apis/core/preference/",draft:!1,unlisted:!1,editUrl:"https://github.com/moodle/devdocs/edit/main/versioned_docs/version-4.1/apis/core/preference/index.md",tags:[{label:"API",permalink:"/moodledevdocs/docs/4.1/tags/api"},{label:"User Preferences",permalink:"/moodledevdocs/docs/4.1/tags/user-preferences"},{label:"User",permalink:"/moodledevdocs/docs/4.1/tags/user"}],version:"4.1",lastUpdatedBy:"Andrew Nicols",lastUpdatedAt:1670648742e3,frontMatter:{title:"Preference API",tags:["API","User Preferences","User"]},sidebar:"docs",previous:{title:"Navigation API",permalink:"/moodledevdocs/docs/4.1/apis/core/navigation/"},next:{title:"User-related APIs",permalink:"/moodledevdocs/docs/4.1/apis/core/user/"}},i={},d=[{value:"Primary functions",id:"primary-functions",level:2},{value:"get_user_preferences()",id:"get_user_preferences",level:3},{value:"set_user_preference()",id:"set_user_preference",level:3},{value:"set_user_preferences()",id:"set_user_preferences",level:3},{value:"unset_user_preference()",id:"unset_user_preference",level:3},{value:"Example usage of the API",id:"example-usage-of-the-api",level:2}];function u(e){const r={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.A,{frontMatter:o,metadata:l}),"\n",(0,s.jsx)(r.p,{children:"The Preference API is used for the storage and retrieval of user preferences. These preferences are stored in the database for users with an account, however for guests or users who are not currently logged in the preferences are stored in the Session."}),"\n",(0,s.jsx)(r.p,{children:"All of these functions operate on the current user by default, however you can specify the user you wish to operate on by passing a user ID or a moodle user object to the $user parameter. Normally this is used for state indicators, where it can be as simple as a yes or no, however you can also use it to store more complex user data, such as a serialized PHP object."}),"\n",(0,s.jsx)(r.p,{children:"It is considered good practice to abstain from storing default values as a user preference as this creates a lot of redundancy. Instead you should apply the default value at the code level if there is no stored value for a given preference."}),"\n",(0,s.jsx)(r.h2,{id:"primary-functions",children:"Primary functions"}),"\n",(0,s.jsx)(r.h3,{id:"get_user_preferences",children:"get_user_preferences()"}),"\n",(0,s.jsx)(r.p,{children:"This function can be used to fetch the value of a requested (via $name) preference, or if it doesn't exist the value given in the $default parameter will be returned. If you do not specify a $name then all preferences will be returned."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-php",children:"get_user_preferences(\n    string $name = null,\n    mixed $default = null,\n    stdClass|int|null $user = null\n): mixed;\n"})}),"\n",(0,s.jsx)(r.h3,{id:"set_user_preference",children:"set_user_preference()"}),"\n",(0,s.jsx)(r.p,{children:"This function can be used to set the value of a preference named $name."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-php",children:"set_user_preference(\n    string $name,\n    mixed $value,\n    stdClass|int|null $user = null\n): bool;\n"})}),"\n",(0,s.jsx)(r.h3,{id:"set_user_preferences",children:"set_user_preferences()"}),"\n",(0,s.jsxs)(r.p,{children:["This function takes an array or preferences containing the name and value for each preference. For each element in the array this function passes the keys and values of each element as the $name and $value parameters (respectively) in calls to ",(0,s.jsx)(r.code,{children:"set_user_preferences()"}),"."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-php",children:"set_user_preferences(\n    array $preferences,\n    stdClass|int|null $user = null\n): bool;\n"})}),"\n",(0,s.jsx)(r.h3,{id:"unset_user_preference",children:"unset_user_preference()"}),"\n",(0,s.jsx)(r.p,{children:"This deletes the requested preference, specified by the $name parameter."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-php",children:"unset_user_preference(\n    string $name,\n    stdClass|int|null $user = null\n): bool;\n"})}),"\n",(0,s.jsx)(r.h2,{id:"example-usage-of-the-api",children:"Example usage of the API"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-php",metastring:'title="Set a preference and then retrieve it"',children:"set_user_preference('foo_nameformat', 'long');\n\n// Returns the string - \"long\"\nget_user_preferences('foo_nameformat');\n"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-php",metastring:'title="Set another preference and then retrieve all preferences"',children:"set_user_preference('foo_showavatars', 'no');\n\n// returns [\n//     foo_nameformat  => \"long\",\n//     foo_showavatars => \"no\",\n// ];\nget_user_preferences();\n"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-php",metastring:'title="Add an array of preferences and change foo_nameformat to short"',children:"$preferences = [\n    'foo_displaynum' => '100',\n    'foo_nameformat' => 'short',\n];\n\nset_user_preferences($preferences);\n\n// returns [\n//     foo_nameformat  => \"short\",\n//     foo_showavatars => \"no\",\n//     foo_displaynum  => \"100\",\n// ];\nget_user_preferences();\n"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-php",metastring:'title="Delete a preference"',children:'unset_user_preference(\'foo_showavatars\');\n\n// returns [\n//     foo_nameformat  => "short",\n//     foo_displaynum  => "yes",\n// ];\nget_user_preferences();\n'})})]})}function p(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}}}]);