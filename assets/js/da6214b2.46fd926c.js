"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[12697],{69652:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>g,frontMatter:()=>l,metadata:()=>d,toc:()=>c});var s=i(74848),o=i(28453),r=i(78924);const l={title:"Exception Tracing",tags:["tools","debugging","exceptions"]},t=void 0,d={id:"development/tools/exceptiontracing",title:"Exception Tracing",description:"Exceptions, and errors are a fact of life as a developer, and dealing with them in development should be as easy and painless as possible.",source:"@site/general/development/tools/exceptiontracing.md",sourceDirName:"development/tools",slug:"/development/tools/exceptiontracing",permalink:"/moodledevdocs/general/development/tools/exceptiontracing",draft:!1,unlisted:!1,editUrl:"https://github.com/moodle/devdocs/edit/main/general/development/tools/exceptiontracing.md",tags:[{label:"tools",permalink:"/moodledevdocs/general/tags/tools"},{label:"debugging",permalink:"/moodledevdocs/general/tags/debugging"},{label:"exceptions",permalink:"/moodledevdocs/general/tags/exceptions"}],version:"current",lastUpdatedBy:"Andrew Nicols",lastUpdatedAt:1713332374e3,frontMatter:{title:"Exception Tracing",tags:["tools","debugging","exceptions"]},sidebar:"coding",previous:{title:"Composer",permalink:"/moodledevdocs/general/development/tools/composer"},next:{title:"Generator tool",permalink:"/moodledevdocs/general/development/tools/generator"}},a={},c=[{value:"Debugging messages",id:"debugging-messages",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Disabling the UI",id:"disabling-the-ui",level:3},{value:"Configuring the &quot;Open&quot; links for your preferred editor",id:"configuring-the-open-links-for-your-preferred-editor",level:3},{value:"Treating debugging as an error",id:"treating-debugging-as-an-error",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components},{Since:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Since",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.A,{frontMatter:l,metadata:d}),"\n",(0,s.jsx)(i,{versions:["4.4"],issueNumber:"MDL-79974"}),"\n",(0,s.jsx)(n.p,{children:"Exceptions, and errors are a fact of life as a developer, and dealing with them in development should be as easy and painless as possible."}),"\n",(0,s.jsxs)(n.p,{children:["From Moodle 4.4 onwards Moodle can use the ",(0,s.jsx)(n.a,{href:"https://github.com/filp/whoops",children:"whoops library"})," to display most Exceptions to developers."]}),"\n",(0,s.jsx)(n.p,{children:"The library is included with Composer, in the same way that other developer-only features are included, and is only enabled when debugging modes are enabled. It can also be disabled as a developer preference."}),"\n",(0,s.jsx)(n.p,{children:"The whoops UI is only used when the following conditions are met:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$CFG->debugdisplay"})," is ",(0,s.jsx)(n.code,{children:"true"}),";"]}),"\n",(0,s.jsxs)(n.li,{children:["the script is not:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["a CLI script using the ",(0,s.jsx)(n.code,{children:"CLI_SCRIPT"})," constant"]}),"\n",(0,s.jsxs)(n.li,{children:["an AJAX script using the ",(0,s.jsx)(n.code,{children:"AJAX_SCRIPT"})," constant"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["the error is not accessed:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"during a PHPUnit test; or"}),"\n",(0,s.jsx)(n.li,{children:"during a Behat run."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["the ",(0,s.jsx)(n.code,{children:"$CFG->debug_developer_use_pretty_exceptions"})," value is not ",(0,s.jsx)(n.code,{children:"false"})]}),"\n",(0,s.jsxs)(n.li,{children:["the whoops library is available (using ",(0,s.jsx)(n.code,{children:"composer install"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"debugging-messages",children:"Debugging messages"}),"\n",(0,s.jsxs)(n.p,{children:["Moodle typically show debugging messages created with the ",(0,s.jsx)(n.code,{children:"debugging()"})," method inline, however this can be easy to miss."]}),"\n",(0,s.jsxs)(n.p,{children:["If Whoops is configured then ",(0,s.jsx)(n.code,{children:"debugging()"})," messages will instead trigger an error and be shown using the Whoops UI."]}),"\n",(0,s.jsxs)(n.p,{children:["This can be controlled using the ",(0,s.jsx)(n.code,{children:"$CFG->debug_developer_debugging_as_error"})," setting."]}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"The use of whoops, and some features of it, are configurable to suit your personal preferences."}),"\n",(0,s.jsx)(n.h3,{id:"disabling-the-ui",children:"Disabling the UI"}),"\n",(0,s.jsx)(n.p,{children:"If you do not wish to use the whoops interface you can disable it by setting the following:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",metastring:'title="config.php"',children:"// Do not use Pretty Exception in the UI.\n$CFG->debug_developer_use_pretty_exceptions = false;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"configuring-the-open-links-for-your-preferred-editor",children:'Configuring the "Open" links for your preferred editor'}),"\n",(0,s.jsxs)(n.p,{children:['The whoops UI can be configured to allow you to easily open files in your preferred editor using the "Open file" link in the UI. This can be configured in Moodle using the ',(0,s.jsx)(n.code,{children:"$CFG->debug_developer_editor"})," property."]}),"\n",(0,s.jsx)(n.p,{children:"The following editors are available as standard:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"emacs"}),"\n",(0,s.jsx)(n.li,{children:"idea"}),"\n",(0,s.jsx)(n.li,{children:"macvim"}),"\n",(0,s.jsx)(n.li,{children:"phpstorm"}),"\n",(0,s.jsx)(n.li,{children:"sublime"}),"\n",(0,s.jsx)(n.li,{children:"textmate"}),"\n",(0,s.jsx)(n.li,{children:"xdebug"}),"\n",(0,s.jsx)(n.li,{children:"vscode"}),"\n",(0,s.jsx)(n.li,{children:"atom"}),"\n",(0,s.jsx)(n.li,{children:"espresso"}),"\n",(0,s.jsx)(n.li,{children:"netbeans"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",metastring:'title="config.php"',children:"$CFG->debug_developer_editor = 'vscode';\n"})}),"\n",(0,s.jsxs)(n.admonition,{title:"Adding your own editor",type:"tip",children:[(0,s.jsx)(n.p,{children:"If your editor is not included in this list, but does support opening files using a URI handler then you can specify a callable which returns the URI, for example:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",metastring:'title="config.php"',children:'$CFG->debug_developer_editor = fn ($file, $line) => "whatever://open?file=$file&line=$line";\n'})}),(0,s.jsxs)(n.p,{children:["For full documentation on this feature, see the ",(0,s.jsx)(n.a,{href:"https://github.com/filp/whoops/blob/master/docs/Open%20Files%20In%20An%20Editor.md",children:"whoops documentation"}),"."]})]}),"\n",(0,s.jsx)(n.h3,{id:"treating-debugging-as-an-error",children:"Treating debugging as an error"}),"\n",(0,s.jsxs)(n.p,{children:["In normal circumstances Moodle will treat all calls to ",(0,s.jsx)(n.code,{children:"debugging()"})," as an informational message which is shown inline in the page body."]}),"\n",(0,s.jsx)(n.p,{children:"You may wish to treat these as Errors instead, especially when updating code between Moodle versions."}),"\n",(0,s.jsxs)(n.p,{children:["The default behaviour for ",(0,s.jsx)(n.code,{children:"debugging()"})," is:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["if the whoops UI is installed, and available, then treat ",(0,s.jsx)(n.code,{children:"debugging()"})," as an Error;"]}),"\n",(0,s.jsxs)(n.li,{children:["otherwise treat ",(0,s.jsx)(n.code,{children:"debugging()"})," as an informational message only."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Thi scan be further configured by setting the ",(0,s.jsx)(n.code,{children:"$CFG->debug_developer_debugging_as_error"})," property:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$CFG->debug_developer_debugging_as_error = true;"})," - always treat debugging calls as an error, whether whoops is available or not;"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$CFG->debug_developer_debugging_as_error = false;"})," - never treat debugging calls as an Error, even when whoops is available."]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);