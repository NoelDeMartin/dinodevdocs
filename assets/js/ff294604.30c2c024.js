"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[85082],{22957:(e,i,t)=>{t.d(i,{A:()=>p});t(96540);var r=t(44744),n=t(65285),l=t(1489),s=t(8193),o=t(28453),a=t(74848);const d=function(e,i,t){return void 0===t&&(t="info"),(0,a.jsx)(l.Ay,{item:!0,children:(0,a.jsx)(n.A,{title:i,children:(0,a.jsx)(r.A,{label:e,color:t})})},e)};function c(e){const{example:i,open:t=!1}=e;return i?(0,a.jsx)(l.Ay,{item:!0,xs:12,children:(0,a.jsx)(s.A,{summary:(0,a.jsx)("summary",{children:"View example"}),open:t,children:i})}):null}function p(e){const{filepath:i,summary:t}=e,r=function(e){let{required:i=!1,legacy:t=!1,deprecated:r=!1,refreshedDuringUpgrade:n=!1,refreshedDuringPurge:l=!1}=e;const s=[];return n&&s.push(d("Upgradable","Changes to this file or directory will be re-applied during a Moodle upgrade. If you make any changes to it, you can simply increment the version number and perform a Moodle upgrade.","info")),l&&s.push(d("Refreshed on cache purge","The contents of this file or directory are cached. To see your changes you can simply purge Moodle's caches and refresh the page.","info")),i&&s.push(d("Required","This file must be present","success")),t&&s.push(d("Legacy","Use of this file is being phased out. It is still supported for older installations but will be removed..","warning")),r&&s.push(d("Deprecated","Use of this file is deprecated and not recommended.It may still be provided for older versions of Moodle but is no longer used.","error")),s}(e),n=e.description?(0,a.jsx)(l.Ay,{item:!0,xs:12,children:e.description}):null;return(0,a.jsx)(o.x,{children:(0,a.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,a.jsx)(l.Ay,{item:!0,xs:6,children:(0,a.jsx)("h4",{children:t})}),(0,a.jsx)(l.Ay,{item:!0,xs:6,children:(0,a.jsx)(l.Ay,{container:!0,spacing:2,justifyContent:"flex-end",children:r})}),(0,a.jsx)(l.Ay,{item:!0,xs:12,children:(0,a.jsxs)("h5",{children:["File path:"," ",i]})}),n,c(e)]})})}},37019:(e,i,t)=>{t.d(i,{rI:()=>p});t(96540);var r=t(47945);const n=JSON.parse('{"plugintypes":{"antivirus":"lib/antivirus","availability":"availability/condition","qtype":"question/type","mod":"mod","auth":"auth","calendartype":"calendar/type","communication":"communication/provider","customfield":"customfield/field","enrol":"enrol","message":"message/output","block":"blocks","media":"media/player","filter":"filter","editor":"lib/editor","format":"course/format","dataformat":"dataformat","profilefield":"user/profile/field","report":"report","coursereport":"course/report","gradeexport":"grade/export","gradeimport":"grade/import","gradereport":"grade/report","gradingform":"grade/grading/form","mlbackend":"lib/mlbackend","mnetservice":"mnet/service","webservice":"webservice","repository":"repository","portfolio":"portfolio","search":"search/engine","qbank":"question/bank","qbehaviour":"question/behaviour","qformat":"question/format","plagiarism":"plagiarism","tool":"admin/tool","cachestore":"cache/stores","cachelock":"cache/locks","fileconverter":"files/converter","contenttype":"contentbank/contenttype","theme":"theme","local":"local","h5plib":"h5p/h5plib","paygw":"payment/gateway"},"subsystems":{"access":null,"admin":"admin","adminpresets":"admin/presets","analytics":"analytics","antivirus":"lib/antivirus","auth":"auth","availability":"availability","backup":"backup/util/ui","badges":"badges","block":"blocks","blog":"blog","bulkusers":null,"cache":"cache","calendar":"calendar","cohort":"cohort","comment":"comment","communication":"communication","competency":"competency","completion":"completion","contentbank":"contentbank","countries":null,"course":"course","courseformat":"course/format","currencies":null,"customfield":"customfield","dbtransfer":null,"debug":null,"editor":"lib/editor","edufields":null,"enrol":"enrol","error":null,"external":"lib/external","favourites":"favourites","filepicker":null,"fileconverter":"files/converter","files":"files","filters":"filter","form":"lib/form","grades":"grade","grading":"grade/grading","group":"group","help":null,"hub":null,"h5p":"h5p","imscc":null,"install":null,"iso6392":null,"langconfig":null,"license":null,"mathslib":null,"media":"media","message":"message","mimetypes":null,"mnet":"mnet","my":"my","notes":"notes","pagetype":null,"payment":"payment","pix":null,"plagiarism":"plagiarism","plugin":null,"portfolio":"portfolio","privacy":"privacy","question":"question","rating":"rating","reportbuilder":"reportbuilder","repository":"repository","rss":"rss","role":"admin/roles","search":"search","table":"lib/table","tag":"tag","timezones":null,"user":"user","userkey":"lib/userkey","webservice":"webservice","xapi":"lib/xapi"}}');var l=t(74848);const s=e=>i=>{let{plugintype:t="plugintype",pluginname:r="pluginname",filepath:n=null}=i,l=(e=>i=>e.plugintypes[i]?e.plugintypes[i]:`[path/to/${i}]`)(e)(t);return l+=r?`/${r}`:"/[pluginname]",`${l}${n}`},o=s(n),a=(o(n),e=>{if(!e.showFileHeader)return"";switch(e?.filetype){case"xml":return"";case"js":case"javascript":return(e=>{let{plugintype:i="plugintype",pluginname:t="pluginname",examplePurpose:r,modulename:n}=e;if(!r)throw Error("Purpose must be specified");if(!n)throw Error("AMD Module name must be specified");return["/**",` * ${r} for the ${i}_${t} plugin.`," *",` * @module   ${i}_${t}/${n}`," * @copyright Year, You Name <your@email.address>"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */",""].join("\n")})(e);case"yui":return(e=>{let{plugintype:i="plugintype",pluginname:t="pluginname",examplePurpose:r,modulename:n}=e;if(!r)throw Error("Purpose must be specified");if(!n)throw Error("YUI Module name must be specified");return["/*",` * @package   ${i}_${t}`," * @copyright Year, You Name <your@email.address>"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */","","/**",` * @module moodle-${i}_${t}-${n}`," */",""].join("\n")})(e);default:return(e=>{let{plugintype:i="plugintype",pluginname:t="pluginname",examplePurpose:r}=e;if(!r)throw Error("Purpose must be specified");return["/**",` * ${r} for the ${i}_${t} plugin.`," *",` * @package   ${i}_${t}`," * @copyright Year, You Name <your@email.address>"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */",""].join("\n")})(e)}}),d=e=>e.showLicense?(e.filetype,"// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n"):"",c=e=>{let{filetype:i="php"}=e;switch(i){case"js":case"javascript":return"javascript";case"xml":return"xml";case"php":case null:return"php";default:return i}},p=(u=n,(e,i)=>{const t={plugintype:"plugintype",showLicense:!0,showFileHeader:!0,filepath:e.exampleFilepath??e.filepath,...e},n=s(u),o=function(e,i){void 0===i&&(i=null);const t=[d(e),a(e),e.example?e.example:i||null].filter((e=>e)).map((e=>e.trim())).join("\n\n");return[(e=>{let{filetype:i="php"}=e;switch(i){case"js":case"javascript":case"xml":return null;default:return"<?php"}})(e),t].filter((e=>e)).join("\n")}(t,i);return(0,l.jsx)(r.A,{title:n(t),language:c(t),children:o})});var u},17623:(e,i,t)=>{t.d(i,{ul:()=>d});var r=t(96540),n=t(22957),l=t(28453),s=t(37019),o=t(74848);const a=e=>"boolean"!=typeof e&&e?"string"==typeof e||r.isValidElement(e)?(0,o.jsx)(l.x,{children:e}):(0,o.jsx)(l.x,{children:(0,o.jsx)(e,{})}):null,d=e=>{const i=(e=>({filetype:"php",examplePurpose:e.summary,...e}))({examplePurpose:e?.summary??null,...e});return i.description=((e,i)=>{let{description:t=null,extraDescription:r=null,children:n=null}=e;if(n){const e=a(n);return(0,o.jsx)(l.x,{children:e})}if(t){const e=a(t);return(0,o.jsx)(l.x,{children:e})}const s=a(i),d=a(r);return s?(0,o.jsxs)(l.x,{children:[s,d]}):null})(i,i?.defaultDescription??null),(i?.example||i?.defaultExample)&&(i.example=(0,s.rI)(i,i?.defaultExample??null)),(0,n.A)(i)}},36029:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>o,metadata:()=>d,toc:()=>p});var r=t(74848),n=t(28453),l=t(78924),s=t(17623);const o={title:"Database fields",tags:["mod_data","datafield","plugintype","subplugin"],documentationDraft:!0},a=void 0,d={id:"apis/plugintypes/mod_data/fields",title:"Database fields",description:"The Database activity included with Moodle includes support for several predefined field types, including text, date, and URL. It is also possible to create new field types. For example, you might like to create:",source:"@site/versioned_docs/version-4.1/apis/plugintypes/mod_data/fields.md",sourceDirName:"apis/plugintypes/mod_data",slug:"/apis/plugintypes/mod_data/fields",permalink:"/moodledevdocs/docs/4.1/apis/plugintypes/mod_data/fields",draft:!1,unlisted:!1,editUrl:"https://github.com/moodle/devdocs/edit/main/versioned_docs/version-4.1/apis/plugintypes/mod_data/fields.md",tags:[{label:"mod_data",permalink:"/moodledevdocs/docs/4.1/tags/mod-data"},{label:"datafield",permalink:"/moodledevdocs/docs/4.1/tags/datafield"},{label:"plugintype",permalink:"/moodledevdocs/docs/4.1/tags/plugintype"},{label:"subplugin",permalink:"/moodledevdocs/docs/4.1/tags/subplugin"}],version:"4.1",lastUpdatedBy:"Andrew Nicols",lastUpdatedAt:1670648742e3,frontMatter:{title:"Database fields",tags:["mod_data","datafield","plugintype","subplugin"],documentationDraft:!0},sidebar:"docs",previous:{title:"Database activity sub-plugins",permalink:"/moodledevdocs/docs/4.1/apis/plugintypes/mod_data/"},next:{title:"Database presets",permalink:"/moodledevdocs/docs/4.1/apis/plugintypes/mod_data/presets"}},c={},p=[{value:"File structure",id:"file-structure",level:2},{value:"Field class",id:"field-class",level:3},{value:"Field configuration form",id:"field-configuration-form",level:3}];function u(e){const i={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components},{Details:t}=i;return t||function(e,i){throw new Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.A,{frontMatter:o,metadata:d}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.a,{href:"https://docs.moodle.org/en/Database_module",children:"Database activity"})," included with Moodle includes support for several predefined ",(0,r.jsx)(i.a,{href:"/moodledevdocs/docs/4.1/apis/plugintypes/mod_data/fields",children:"field types"}),", including text, date, and URL. It is also possible to create new field types. For example, you might like to create:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:'Discipline-specific field types - For example "Protein PDB code": users can enter the PDB code for a protein, and then the display 3D viewer for the protein structure, or link out to molecular databases.'}),"\n",(0,r.jsx)(i.li,{children:'Institution-specific field types -  For example "library reference number": Allow users to enter a reference number which can be automatically turned into a direct link for local library services.'}),"\n",(0,r.jsx)(i.li,{children:'Module-specific field types - For example "wiki page": users see a drop-down list containing the names of pages in your wiki, and can choose which page this particular entry refers to.'}),"\n"]}),"\n","\n",(0,r.jsx)(i.h2,{id:"file-structure",children:"File structure"}),"\n",(0,r.jsxs)(i.p,{children:["Database field sub-plugins are located in the ",(0,r.jsx)(i.code,{children:"/mod/data/field"})," directory."]}),"\n",(0,r.jsxs)(i.p,{children:["Each plugin is in a separate subdirectory and consists of a number of ",(0,r.jsx)(i.em,{children:"mandatory files"})," and any other files the developer is going to use."]}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsxs)("summary",{children:["View an example directory layout for the ",(0,r.jsx)(i.code,{children:"datafield_number"})," subplugin."]}),(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-console",children:"mod/data/field/number\n\u251c\u2500\u2500 classes\n\u2502\xa0\xa0 \u2514\u2500\u2500 privacy\n\u2502\xa0\xa0     \u2514\u2500\u2500 provider.php\n\u251c\u2500\u2500 field.class.php\n\u251c\u2500\u2500 lang\n\u2502\xa0\xa0 \u2514\u2500\u2500 en\n\u2502\xa0\xa0     \u2514\u2500\u2500 datafield_number.php\n\u251c\u2500\u2500 mod.html\n\u2514\u2500\u2500 version.php\n"})})]}),"\n",(0,r.jsxs)(i.p,{children:["Some of the important files for the database field plugintype are described below. See the ",(0,r.jsx)(i.a,{href:"/moodledevdocs/docs/4.1/apis/commonfiles/",children:"common plugin files"})," documentation for details of other files which may be useful in your plugin."]}),"\n",(0,r.jsx)(i.h3,{id:"field-class",children:"Field class"}),"\n",(0,r.jsx)(s.ul,{filepath:"/field.class.php",required:!0,summary:"Definition of the field type"}),"\n",(0,r.jsxs)(i.p,{children:["The field, its behaviours, and its properties, are defined in a class named ",(0,r.jsx)(i.code,{children:"data_field_[pluginname]"})," located in ",(0,r.jsx)(i.code,{children:"field.class.php"}),". This class must extend the ",(0,r.jsx)(i.code,{children:"data_field_base"})," base class."]}),"\n",(0,r.jsx)(i.admonition,{title:"Class locations",type:"danger",children:(0,r.jsxs)(i.p,{children:["The field definition is currently located in the ",(0,r.jsx)(i.code,{children:"field.class.php"})," file and is not yet autoloaded by Moodle."]})}),"\n",(0,r.jsx)(i.p,{children:"The base class defines some simple behaviours which you can override in your plugin. The following functions are of particular interest:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"display_add_field($recordid = 0)"})," - Return some HTML for use when a user is adding/editing a record"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"display_browse_field($recordid, $template)"})," - Return some HTML for displaying a record"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"update_content($recordid, $value, $name = '')"})," - Store the data entered by a user for a record"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"get_sort_sql($fieldname)"})," - Specify SQL for how this field should be sorted"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"get_content_value($value)"})," - Useful if the info stored in the database if different from the info that ends up being presented to the user"]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"field-configuration-form",children:"Field configuration form"}),"\n",(0,r.jsx)(s.ul,{filepath:"/mod.html",required:!0,summary:"Form definition for adding and editing the field configuration"}),"\n",(0,r.jsx)(i.admonition,{type:"danger",children:(0,r.jsx)(i.p,{children:"The field definition is one of the older parts of Moodle and does not use best practice."})})]})}function m(e={}){const{wrapper:i}={...(0,n.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);