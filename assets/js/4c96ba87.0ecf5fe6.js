"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[94393],{34751:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var i=n(74848),t=n(28453),s=n(78924);const r={title:"Using the Moodle App in a browser",sidebar_label:"Using the App in a browser",sidebar_position:1,tags:["Moodle App"]},a=void 0,l={id:"app/development/setup/app-in-browser",title:"Using the Moodle App in a browser",description:"Browsers are not officially supported by the application in production, but you can use a Chromium-based browser for development if you don't need any native functionality.",source:"@site/general/app/development/setup/app-in-browser.md",sourceDirName:"app/development/setup",slug:"/app/development/setup/app-in-browser",permalink:"/moodledevdocs/general/app/development/setup/app-in-browser",draft:!1,unlisted:!1,editUrl:"https://github.com/moodle/devdocs/edit/main/general/app/development/setup/app-in-browser.md",tags:[{label:"Moodle App",permalink:"/moodledevdocs/general/tags/moodle-app"}],version:"current",lastUpdatedBy:"Noel De Martin",lastUpdatedAt:1719423845e3,sidebarPosition:1,frontMatter:{title:"Using the Moodle App in a browser",sidebar_label:"Using the App in a browser",sidebar_position:1,tags:["Moodle App"]},sidebar:"moodleapp",previous:{title:"Setting up your environment",permalink:"/moodledevdocs/general/app/development/setup/"},next:{title:"Docker images",permalink:"/moodledevdocs/general/app/development/setup/docker-images"}},d={},c=[{value:"Differences between Chromium and Google Chrome",id:"differences-between-chromium-and-google-chrome",level:2},{value:"Advantages and disadvantages of using a browser instead of a native device",id:"advantages-and-disadvantages-of-using-a-browser-instead-of-a-native-device",level:2},{value:"Installation and configuration",id:"installation-and-configuration",level:2},{value:"Creating a shortcut",id:"creating-a-shortcut",level:3},{value:"Configuring the default browser",id:"configuring-the-default-browser",level:3},{value:"Handling deep links",id:"handling-deep-links",level:2},{value:"Using the hosted versions of the app",id:"using-the-hosted-versions-of-the-app",level:2},{value:"Special headers",id:"special-headers",level:3},{value:"Tips &amp; tricks",id:"tips--tricks",level:2}];function h(e){const o={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.A,{frontMatter:r,metadata:l}),"\n",(0,i.jsxs)(o.p,{children:["Browsers are not officially supported by the application in production, but you can use a ",(0,i.jsx)(o.strong,{children:"Chromium-based"})," browser for development if you don't need any native functionality."]}),"\n",(0,i.jsxs)(o.p,{children:["The Chromium version needs to be 102 or newer, because the app's use of the ",(0,i.jsx)(o.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/FileSystemFileHandle/createSyncAccessHandle",children:"File System Access API"})," during development."]}),"\n",(0,i.jsx)(o.h2,{id:"differences-between-chromium-and-google-chrome",children:"Differences between Chromium and Google Chrome"}),"\n",(0,i.jsx)(o.p,{children:'Google Chrome is the Chromium open source project built, packaged, and distributed by Google. We can say that Chromium is Google Chrome without the "Google" add-ons. For that reason, we recommend using Chromium instead of Google Chrome.'}),"\n",(0,i.jsx)(o.h2,{id:"advantages-and-disadvantages-of-using-a-browser-instead-of-a-native-device",children:"Advantages and disadvantages of using a browser instead of a native device"}),"\n",(0,i.jsx)(o.p,{children:"Main advantages:"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsx)(o.li,{children:"Faster development."}),"\n",(0,i.jsx)(o.li,{children:"DOM inspector."}),"\n",(0,i.jsx)(o.li,{children:"Network monitor."}),"\n",(0,i.jsx)(o.li,{children:"Emulation options."}),"\n"]}),"\n",(0,i.jsx)(o.p,{children:"Disadvantages:"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsx)(o.li,{children:"You can't use native functionality."}),"\n",(0,i.jsx)(o.li,{children:"SCORM and H5P aren't supported in browsers."}),"\n",(0,i.jsx)(o.li,{children:"If you need to use Cordova plugins, you will probably need to provide a way to emulate those APIs in the browser or avoid calling them in the browser environment."}),"\n",(0,i.jsx)(o.li,{children:"You will always need to test in a native device prior to a production release."}),"\n",(0,i.jsx)(o.li,{children:"You will need to verify that your CSS/layout looks the same in native devices."}),"\n"]}),"\n",(0,i.jsx)(o.h2,{id:"installation-and-configuration",children:"Installation and configuration"}),"\n",(0,i.jsxs)(o.p,{children:["You can install the Chromium browser by downloading it from ",(0,i.jsx)(o.a,{href:"https://www.chromium.org/getting-involved/download-chromium",children:"the official download page"}),"."]}),"\n",(0,i.jsx)(o.p,{children:"In order to run the Moodle App, we recommend that you launch the browser with a couple of arguments. These are necessary to disable some of the limitations that don't exist in the native application, and also prepare the development environment."}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-bash",metastring:'title="Linux"',children:"chromium-browser --allow-file-access-from-files --disable-web-security --disable-site-isolation-trials --allow-running-insecure-content --no-referrers --unlimited-storage --auto-open-devtools-for-tabs --ignore-certificate-errors --disable-infobars --user-data-dir=~/.chromium-dev-data\n"})}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-bash",metastring:'title="Windows"',children:"start chrome.exe --allow-file-access-from-files --disable-web-security --disable-site-isolation-trials --allow-running-insecure-content --no-referrers --unlimited-storage --auto-open-devtools-for-tabs --ignore-certificate-errors --disable-infobars --user-data-dir=~/.chromium-dev-data\n"})}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-bash",metastring:'title="MacOS"',children:"open -a /Applications/Chromium.app --args --allow-file-access-from-files --disable-web-security --disable-site-isolation-trials --allow-running-insecure-content --no-referrers --unlimited-storage --auto-open-devtools-for-tabs --ignore-certificate-errors --disable-infobars --user-data-dir=~/.chromium-dev-data\n"})}),"\n",(0,i.jsxs)(o.p,{children:["If you are using other operative system, check out ",(0,i.jsx)(o.a,{href:"https://www.chromium.org/developers/how-tos/run-chromium-with-flags",children:"how to run chromium with flags"}),' in other environments.\nDepending on the version of your browser, you may get a warning message saying "You are using an unsupported command-line flag". This is expected and can safely be ignored (for development).']}),"\n",(0,i.jsxs)(o.p,{children:["For more info about the user data dir, please read ",(0,i.jsx)(o.a,{href:"https://chromium.googlesource.com/chromium/src/+/master/docs/user_data_dir.md",children:"the official documentation"}),"."]}),"\n",(0,i.jsx)(o.h3,{id:"creating-a-shortcut",children:"Creating a shortcut"}),"\n",(0,i.jsx)(o.p,{children:"We strongly recommend that you create a new shortcut and use it only for working with the app during development. In Linux, and possibly other operating systems, these arguments only work if you don't already have the same browser running. Hence if you use Google Chrome as your normal browser, you can use Chromium for development and vice versa."}),"\n",(0,i.jsxs)(o.p,{children:["In Linux, you can create such a shortcut by writing a script that is globally available. For example, you can create the following file in ",(0,i.jsx)(o.code,{children:"/usr/local/bin/unsafe-chromium"}),":"]}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-bash",children:"chromium-browser --allow-file-access-from-files --disable-web-security --disable-site-isolation-trials --allow-running-insecure-content --no-referrers --unlimited-storage --auto-open-devtools-for-tabs  --ignore-certificate-errors --disable-infobars --user-data-dir=/home/{username}/.chromium-dev-data $@\n"})}),"\n",(0,i.jsxs)(o.p,{children:["Notice that this time we shouldn't use ",(0,i.jsx)(o.code,{children:"~/.chromium-dev-data"})," to describe the user data dir. That's because this file can be called from a different shell, and ",(0,i.jsx)(o.code,{children:"~"}),' could not be interpreted properly (this may end up creating a folder called "~" in your project folder, and you probably don\'t want that).']}),"\n",(0,i.jsxs)(o.p,{children:["Also, remember to make this file executable by running ",(0,i.jsx)(o.code,{children:"sudo chmod +x /usr/local/bin/unsafe-chromium"}),"."]}),"\n",(0,i.jsx)(o.p,{children:"For convenience, you can also define an application launch that calls this script."}),"\n",(0,i.jsx)(o.admonition,{title:"Help wanted!",type:"note",children:(0,i.jsxs)(o.p,{children:["These instructions have only been tested in Linux. If you are using a different operative system, ",(0,i.jsx)(o.a,{href:"https://github.com/moodle/devdocs/issues/76",children:"let us know"})," how it went (or just ",(0,i.jsx)(o.a,{href:"https://github.com/moodle/devdocs/edit/main/general/app/development/setup/app-in-browser.md",children:"edit this page"}),"!)."]})}),"\n",(0,i.jsx)(o.h3,{id:"configuring-the-default-browser",children:"Configuring the default browser"}),"\n",(0,i.jsxs)(o.p,{children:["When you launch the application by running ",(0,i.jsx)(o.code,{children:"npm start"}),", this will open a tab in your default browser. You can close this tab and open the url with your development browser, but if you want to do it automatically you can override the default browser by setting the ",(0,i.jsx)(o.code,{children:"MOODLE_APP_BROWSER"})," environment variable."]}),"\n",(0,i.jsxs)(o.p,{children:["For example, if you have created a shortcut like we mentioned in the previous section, you can just add the following to your ",(0,i.jsx)(o.code,{children:"~/.bashrc"})," file:"]}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-bash",children:"export MOODLE_APP_BROWSER=/usr/local/bin/unsafe-chromium\n"})}),"\n",(0,i.jsx)(o.admonition,{title:"Use absolute paths",type:"caution",children:(0,i.jsx)(o.p,{children:"Make sure to set this variable to an absolute path, and not just the name of the binary. Even if the program is loaded in the global PATH, it will not work unless it's an absolute path."})}),"\n",(0,i.jsx)(o.admonition,{title:"Help wanted!",type:"note",children:(0,i.jsxs)(o.p,{children:["These instructions have only been tested in Linux. If you are using a different operative system, ",(0,i.jsx)(o.a,{href:"https://github.com/moodle/devdocs/issues/76",children:"let us know"})," how it went (or just ",(0,i.jsx)(o.a,{href:"https://github.com/moodle/devdocs/edit/main/general/app/development/setup/app-in-browser.md",children:"edit this page"}),"!)."]})}),"\n",(0,i.jsx)(o.h2,{id:"handling-deep-links",children:"Handling deep links"}),"\n",(0,i.jsx)(o.p,{children:"Using a browser, you'll realize it's not possible to handle deep links, for example if you're trying to log in using SSO."}),"\n",(0,i.jsx)(o.p,{children:"To work around that, you can simulate a deep link being pressed running the following code in the console:"}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-js",children:"handleOpenURL('moodlemobile://token=...');\n"})}),"\n",(0,i.jsx)(o.h2,{id:"using-the-hosted-versions-of-the-app",children:"Using the hosted versions of the app"}),"\n",(0,i.jsxs)(o.p,{children:["You can access your site using the hosted versions of the app in ",(0,i.jsx)(o.a,{href:"https://latest.apps.moodledemo.net",children:"latest.apps.moodledemo.net"})," (the latest stable version) and ",(0,i.jsx)(o.a,{href:"https://main.apps.moodledemo.net",children:"main.apps.moodledemo.net"})," (the current version in development)."]}),"\n",(0,i.jsx)(o.h3,{id:"special-headers",children:"Special headers"}),"\n",(0,i.jsxs)(o.p,{children:["The application also relies on the ",(0,i.jsx)(o.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer",children:"SharedArrayBuffer API"}),", so in case you're hosting the app yourself you'll need to return the following headers:"]}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{children:"Cross-Origin-Opener-Policy: same-origin\nCross-Origin-Embedder-Policy: require-corp\n"})}),"\n",(0,i.jsx)(o.h2,{id:"tips--tricks",children:"Tips & tricks"}),"\n",(0,i.jsxs)(o.p,{children:["Once you have everything set up, you should be able to develop like you would with any other front-end application. You can learn about the development tools you have available by reading the ",(0,i.jsx)(o.a,{href:"https://developer.chrome.com/devtools/index",children:"Chrome DevTools documentation"}),"."]}),"\n",(0,i.jsx)(o.p,{children:"Here's some things we find useful to work with the Moodle App in particular:"}),"\n",(0,i.jsxs)(o.ul,{children:["\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.a,{href:"https://chrome.google.com/webstore/detail/angular-devtools/ienfalfjdbdpebioblfackkekamfmbnh",children:"Angular DevTools"})," \u2014 Browser extension to debug Angular applications during development."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.a,{href:"https://developer.chrome.com/docs/devtools/device-mode/",children:"Device Mode"})," \u2014 You can use this feature to make the browser behave more like a native device. This will work best if you ",(0,i.jsx)(o.a,{href:"https://developer.chrome.com/docs/devtools/customize/placement/",children:"dock the development panel"})," to one side (left or right), but you may want to do something else in your environment."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.a,{href:"https://developer.chrome.com/docs/devtools/console/",children:"Console Panel"})," \u2014 This panel is essential for any developer, since it will show you any errors or custom messages that you've written. You can also use the search box to filter messages seeing everything is too overwhelming. You will also see specific logs from the Moodle App, but keep in mind that they are not used in production environment. If you are not running the application yourself, you can inspect the environment by opening the /assets/env.json url."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.a,{href:"https://developer.chrome.com/docs/devtools/dom/",children:"Elements Panel"})," \u2014 This panel is also essential for any developer, you'll be able to inspect and modify the HTML that is actually being rendered."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.a,{href:"https://developer.chrome.com/docs/devtools/network/",children:"Network Panel"})," \u2014 This panel can be useful if you are trying to see how the Moodle App communicates with a Moodle site. You may also want to ",(0,i.jsx)(o.a,{href:"https://developer.chrome.com/docs/devtools/network/reference/#disable-cache",children:"disable the cache"})," in order to have the same behaviour after each reload. However, keep in mind that this only disables the browser cache, any Web Service calls that are cached by the Moodle App will remain cached. You can learn more about network requests in the ",(0,i.jsx)(o.a,{href:"/moodledevdocs/general/app/development/network-debug",children:"Debugging network requests in the Moodle App"})," page."]}),"\n",(0,i.jsxs)(o.li,{children:[(0,i.jsx)(o.a,{href:"https://chromewebstore.google.com/detail/opfs-explorer/acndjpgkpaclldomagafnognkcgjignd",children:"OPFS Explorer"})," \u2014 This browser extension can be used to view the ",(0,i.jsx)(o.code,{children:".sqlite"})," files of the database. If you download these, you can open them in any SQLite database inspector, for example ",(0,i.jsx)(o.a,{href:"https://sqliteviewer.app/",children:"sqliteviewer.app"}),"."]}),"\n"]})]})}function p(e={}){const{wrapper:o}={...(0,t.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);