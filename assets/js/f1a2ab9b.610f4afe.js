"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[6349],{38482:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>a});var n=t(74848),d=t(28453),o=t(78924);const i={title:"SCSS Deprecation",tags:["Processes","Core development","Deprecation","SCSS"]},c=void 0,r={id:"development/policies/deprecation/scss-deprecation",title:"SCSS Deprecation",description:"Since Moodle 4.4, it's possible to deprecate SCSS styles and classes. This allows us to safely remove SCSS and will help us keep the code cleaner and more organized.",source:"@site/general/development/policies/deprecation/scss-deprecation.md",sourceDirName:"development/policies/deprecation",slug:"/development/policies/deprecation/scss-deprecation",permalink:"/moodledevdocs/general/development/policies/deprecation/scss-deprecation",draft:!1,unlisted:!1,editUrl:"https://github.com/moodle/devdocs/edit/main/general/development/policies/deprecation/scss-deprecation.md",tags:[{label:"Processes",permalink:"/moodledevdocs/general/tags/processes"},{label:"Core development",permalink:"/moodledevdocs/general/tags/core-development"},{label:"Deprecation",permalink:"/moodledevdocs/general/tags/deprecation"},{label:"SCSS",permalink:"/moodledevdocs/general/tags/scss"}],version:"current",lastUpdatedBy:"Andrew Nicols",lastUpdatedAt:1713332374e3,frontMatter:{title:"SCSS Deprecation",tags:["Processes","Core development","Deprecation","SCSS"]},sidebar:"coding",previous:{title:"Deprecation",permalink:"/moodledevdocs/general/development/policies/deprecation/"},next:{title:"Designing usable forms",permalink:"/moodledevdocs/general/development/policies/designing-usable-forms"}},l={},a=[{value:"How it works",id:"how-it-works",level:2},{value:"How to deprecate SCSS code",id:"how-to-deprecate-scss-code",level:2},{value:"Final deprecation",id:"final-deprecation",level:2},{value:"Check deprecated styles in Behat tests",id:"check-deprecated-styles-in-behat-tests",level:2}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,d.R)(),...e.components},{Since:t}=s;return t||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Since",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.A,{frontMatter:i,metadata:r}),"\n",(0,n.jsx)(t,{versions:["4.4"],issueNumber:"MDL-78334"}),"\n",(0,n.jsx)(s.p,{children:"Since Moodle 4.4, it's possible to deprecate SCSS styles and classes. This allows us to safely remove SCSS and will help us keep the code cleaner and more organized."}),"\n",(0,n.jsx)(s.p,{children:"The most common scenarios where this functionality can be used is when specific SCSS code is not being used anywhere, when the name of a class is changed or a class should not be used in the future."}),"\n",(0,n.jsx)(s.admonition,{title:"When should SCSS be removed?",type:"info",children:(0,n.jsx)(s.p,{children:"There are situations where deprecation does not make sense. For example when a whole functionality is being removed, or a very specific SCSS class is no longer used by the code. If it is very unlikely that the SCSS class is used by any other code, it can simply be removed without the full deprecation process."})}),"\n",(0,n.jsx)(s.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,n.jsxs)(s.p,{children:["A new SCSS file called ",(0,n.jsx)(s.code,{children:"deprecated.scss"})," has been added to the ",(0,n.jsx)(s.code,{children:"theme/boost/scss/moodle"})," folder. All the deprecated SCSS code should be added to this file."]}),"\n",(0,n.jsxs)(s.p,{children:["In this file a new mixin called ",(0,n.jsx)(s.code,{children:"deprecated-styles"})," has been also added. This mixin will add a red backgound to the deprecated styles and also a ",(0,n.jsx)(s.code,{children:":before"}),' pseudo-element with the text "Deprecated style in use". It is important to note that ',(0,n.jsx)(s.code,{children:"deprecated-styles"})," mixin will only affect sites with ",(0,n.jsx)(s.code,{children:"themedesignermode"})," setting enabled or behat test running sites."]}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsx)(s.p,{children:"If all the styles depending on the same parent are deprecated, is strongly recommended to deprecate the parent selector."})}),"\n",(0,n.jsx)(s.h2,{id:"how-to-deprecate-scss-code",children:"How to deprecate SCSS code"}),"\n",(0,n.jsx)(s.p,{children:"To deprecate SCSS code, follow these steps:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Remove the SCSS code that is no longer in use from the original file."}),"\n",(0,n.jsxs)(s.li,{children:["Add the removed SCSS code to the ",(0,n.jsx)(s.code,{children:"deprecated.scss"})," file under the comment for the current version ",(0,n.jsx)(s.code,{children:"// Deprecated since Moodle X.Y."})]}),"\n",(0,n.jsxs)(s.li,{children:["Add the ",(0,n.jsx)(s.code,{children:"deprecated-styles"})," mixin to the removed SCSS code."]}),"\n",(0,n.jsx)(s.li,{children:"Add a comment to the removed SCSS code explaining why it has been deprecated."}),"\n"]}),"\n",(0,n.jsx)(s.admonition,{type:"note",children:(0,n.jsxs)(s.p,{children:["If there is no section for the current version in the ",(0,n.jsx)(s.code,{children:"deprecated.scss"})," file, it should be added. See ",(0,n.jsx)(s.a,{href:"#final-deprecation",children:"Final deprecation"}),"."]})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Example 1: Helper class has been removed"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-scss",metastring:'title="theme/boost/scss/moodle/deprecated.scss"',children:'// The class ".foo" is deprecated. Use ".bar" instead.\n.foo {\n  @include deprecated-styles();\n\n  color: $pink;\n  @include border-right-radius(0);\n  border: $border-width solid $border-color;\n  table {\n    margin: 1rem;\n  }\n  table > tbody {\n    padding: .5rem;\n  }\n}\n'})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Example 2: SCSS code is no longer in use"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-scss",metastring:'title="theme/boost/scss/moodle/deprecated.scss"',children:"// The following styles are deprecated because they are no longer in use.\n// Deprecating the parent selector that contains all the deprecated styles.\n.path-course-view li.activity .foo {\n  @include deprecated-styles();\n}\n.path-course-view li.activity .foo > a {\n  text-decoration: none;\n  color: $secondary;\n}\n.path-course-view li.activity .foo > a:hover {\n  color: $primary;\n}\n"})}),"\n",(0,n.jsx)(s.h2,{id:"final-deprecation",children:"Final deprecation"}),"\n",(0,n.jsxs)(s.p,{children:["When adding SCSS code to the ",(0,n.jsx)(s.code,{children:"deprecated.scss"})," file, it is important to add it under the comment with the version when the code was deprecated. If that comment still doesn't exist, it should be added:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-scss",metastring:'title="theme/boost/scss/moodle/deprecated.scss"',children:"//\n// Deprecated since Moodle X.Y.\n//\n"})}),"\n",(0,n.jsxs)(s.p,{children:["And alongside with that, a new issue should be created in the tracker to remove the deprecated SCSS code with the title ",(0,n.jsx)(s.code,{children:"Remove SCSS deprecated in X.Y"})," and in the epic ",(0,n.jsx)(s.code,{children:"X.[Y+4]"})," deprecations."]}),"\n",(0,n.jsxs)(s.p,{children:["After 4 major versions, the deprecated SCSS code will be removed from the ",(0,n.jsx)(s.code,{children:"deprecated.scss"})," file."]}),"\n",(0,n.jsx)(s.h2,{id:"check-deprecated-styles-in-behat-tests",children:"Check deprecated styles in Behat tests"}),"\n",(0,n.jsxs)(s.p,{children:["Is is possible to check if deprecated styles are being used while running Behat tests. To do so, add the ",(0,n.jsx)(s.code,{children:"--scss-deprecations"})," flag to the Behat init command."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"php admin/tool/behat/cli/init.php --scss-deprecations\n"})}),"\n",(0,n.jsx)(s.p,{children:"Then, when running Behat tests, the following message will be displayed:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"Run optional tests:\n[...]\n- SCSS deprecations: Yes\n"})}),"\n",(0,n.jsx)(s.p,{children:"If deprecated styles are being used, the test will fail with the following message:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"Deprecated style in use (Exception)\n"})})]})}function p(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}}}]);